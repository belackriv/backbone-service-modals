!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n(require("backbone.service"),require("backbone"),require("underscore"),require("es6-promise")):"function"==typeof define&&define.amd?define(["backbone.service","backbone","underscore","es6-promise"],n):e.ModalService=n(e.Service,e.Backbone,e._,e.PromisePolyfill)}(this,function(e,n,r,t){"use strict";var i=t.Promise,o=e.extend({requests:function(){return{open:"open",close:"close",alert:"alert",confirm:"confirm",prompt:"prompt"}},constructor:function(){var e=this;this.views=[],this.listenTo(n.history,"route",function(){e.fragment!==n.history.fragment&&(e.fragment=null,e.close())}),this._super.apply(this,arguments)},open:function(e,t){var o=this,u=void 0;return i.resolve().then(function(){return o.trigger("before:open",e,t),o.fragment=n.history.fragment,o._isOpen=!0,u=r.last(o.views),o.views.push(e),o.render(e,t)}).then(function(){return u?o.animateSwap(u,e,t):o.animateIn(e,t)}).then(function(){o.trigger("open",e,t)})},close:function(e,n){var t=this,o=void 0,u=void 0;return i.resolve().then(function(){return e?t.trigger("before:close",e,n):r.map(t.views,function(e){return t.trigger("before:close",e,n)}),t._isOpen=!1,e?u=t.views=r.without(t.views,e):(u=t.views,t.views=[]),o=r.last(u),e&&o?t.animateSwap(e,o,n):e?t.animateOut(e,n):o?t.animateOut(o,n):void 0}).then(function(){return e?t.remove(e,n):Promise.all(r.map(u,function(e){return t.remove(e,n)}))}).then(function(){e?t.trigger("close",e,n):r.map(u,function(e){return t.trigger("close",e,n)})})},alert:function(e){var n=this;return new i(function(r,t){var i=new n.AlertView(e);n.open(i,e),n.trigger("before:alert",i,e),i.on("confirm cancel",function(){n.close(i,e).then(function(){return n.trigger("alert",null,i,e)}).then(r,t)})})},confirm:function(e){var n=this;return new i(function(r,t){var i=new n.ConfirmView(e);n.open(i,e),n.trigger("before:confirm",i,e);var o=function(o){n.close(i,e).then(function(){return n.trigger("confirm",o,i,e)}).then(function(){return r(o)},t)};i.on({confirm:function(){return o(!0)},cancel:function(){return o(!1)}})})},prompt:function(e){var n=this;return new i(function(r,t){var i=new n.PromptView(e);n.open(i,e),n.trigger("before:prompt",i,e);var o=function(o){n.close(i,e).then(function(){return n.trigger("prompt",o,i,e)}).then(function(){return r(o)},t)};i.on({submit:function(e){return o(e)},cancel:function(){return o()}})})},isOpen:function(){return!!this._isOpen},render:function(){},remove:function(){},animateIn:function(){},animateSwap:function(){},animateOut:function(){}});return o});
//# sourceMappingURL=backbone-service-modals.min.js.map