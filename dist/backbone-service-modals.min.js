!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("backbone.service"),require("backbone"),require("underscore"),require("es6-promise")):"function"==typeof define&&define.amd?define(["backbone.service","backbone","underscore","es6-promise"],e):n.ModalService=e(n.Service,n.Backbone,n._,n.PromisePolyfill)}(this,function(n,e,t,r){"use strict";var i=r.Promise,o=n.extend({requests:function(){return{open:"open",close:"close",alert:"alert",confirm:"confirm",prompt:"prompt"}},constructor:function(){var n=this;this.views=[],this.listenTo(e.history,"route",function(){n.fragment!==e.history.fragment&&(n.fragment=null,n.close())}),this._super.apply(this,arguments)},open:function(n){var r=this,o=void 0;return i.resolve().then(function(){return r.fragment=e.history.fragment,r._isOpen=!0,o=t.last(r.views),r.views.push(n),r.render(n)}).then(function(){return o?r.animateSwap(o,n):r.animateIn(n)})},close:function(n){var e=this,r=void 0,o=void 0;return i.resolve().then(function(){return e._isOpen=!1,n?o=e.views=t.without(e.views,n):(o=e.views,e.views=[]),r=t.last(o),n&&r?e.animateSwap(n,r):n?e.animateOut(n):r?e.animateOut(r):void 0}).then(function(){return n?e.remove(n):Promise.all(t.map(o,e.remove,e))})},alert:function(n){var e=this;return new i(function(t,r){var i=new e.AlertView(n),o=e.open(i);i.on("confirm cancel",function(){o.then(function(){return e.close(i)}).then(t,r)})})},confirm:function(n){var e=this;return new i(function(t,r){var i=new e.ConfirmView(n),o=e.open(i),u=function(n){o.then(function(){return e.close(i)}).then(function(){return t(n)},r)};i.on({confirm:function(){return u(!0)},cancel:function(){return u(!1)}})})},prompt:function(n){var e=this;return new i(function(t,r){var i=new e.PromptView(n),o=e.open(i),u=function(n){o.then(function(){return e.close(i)}).then(function(){return t(n)},r)};i.on({submit:function(n){return u(n)},cancel:function(){return u()}})})},isOpen:function(){return!!this._isOpen},render:function(){},remove:function(){},animateIn:function(){},animateSwap:function(){},animateOut:function(){}});return o});
//# sourceMappingURL=backbone-service-modals.min.js.map